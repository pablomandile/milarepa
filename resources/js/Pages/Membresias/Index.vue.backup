<script setup>
import AppLayout from '@/Layouts/AppLayout.vue';
import { Link, router } from '@inertiajs/vue3';
import DataView from 'primevue/dataview';
import { ref } from 'vue';

const props = defineProps({
    membresias: {
        type: Object,
        required: true
    }
});

const layout = ref('grid');
</script>

<template>
    <AppLayout>
        <div class="py-12">
            <div class="px-4 sm:px-6 lg:px-8">
                <div class="bg-white border-round shadow-1">
                    <div class="p-6 border-bottom-1 border-200">
                        <div class="flex justify-content-between align-items-center mb-4">
                            <h2 class="text-2xl font-bold text-900 m-0">Membresías Disponibles</h2>
                            <div class="flex gap-2">
                                <button
                                    @click="layout = 'grid'"
                                    :class="['p-button p-button-text p-button-rounded', layout === 'grid' ? 'p-button-primary' : 'p-button-secondary']"
                                >
                                    <i class="pi pi-th-large"></i>
                                </button>
                                <button
                                    @click="layout = 'list'"
                                    :class="['p-button p-button-text p-button-rounded', layout === 'list' ? 'p-button-primary' : 'p-button-secondary']"
                                >
                                    <i class="pi pi-list"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mt-4">
                            <DataView
                                :value="membresias.data"
                                :layout="layout"
                                paginator
                                :rows="9"
                                :rowsPerPageOptions="[3, 6, 9]"
                                class="mb-6"
                            >
                                <template #grid="slotProps">
                            <div class="grid grid-nogutter">
                            <!-- Recorremos las membresias -->
                            <div
                                v-for="(membresia, index) in slotProps.items"
                                :key="membresia.id"
                                class="col-12 md:col-6 xl:col-4 p-2"
                            >
                                <!-- Tarjeta de membresia -->
                                <div class="p-card bg-white border-1 surface-border border-round shadow-2 hover:shadow-4 transition-all transition-duration-300 cursor-pointer">
                                    <div class="p-card-body p-4">
                                        <div class="flex flex-col h-full">
                                            <!-- Header con icono -->
                                            <div class="flex align-items-center mb-3">
                                                <div class="bg-primary-100 border-circle w-3rem h-3rem flex align-items-center justify-content-center mr-3">
                                                    <i class="pi pi-star text-primary text-xl"></i>
                                                </div>
                                                <div class="flex-1">
                                                    <h3 class="p-card-title text-lg font-bold text-900 m-0 line-height-1">
                                                        {{ membresia.nombre }}
                                                    </h3>
                                                </div>
                                            </div>

                                            <!-- Descripción -->
                                            <p class="p-card-subtitle text-sm text-600 mb-3 flex-1 line-height-2">
                                                {{ membresia.descripcion || 'Sin descripción disponible' }}
                                            </p>

                                            <!-- Entidad -->
                                            <div class="flex align-items-center mb-4">
                                                <i class="pi pi-building text-400 mr-2"></i>
                                                <span class="text-sm text-500">
                                                    <strong>{{ membresia.entidad?.nombre || 'No especificada' }}</strong>
                                                </span>
                                            </div>

                                            <!-- Botón -->
                                            <div class="mt-auto">
                                                <Link
                                                    :href="route('registromembresias.create', { membresia_id: membresia.id })"
                                                    class="p-button p-button-primary p-button-rounded w-full text-center no-underline hover:bg-primary-600 transition-colors transition-duration-200"
                                                >
                                                    <i class="pi pi-plus-circle mr-2"></i>
                                                    Inscribirme
                                                </Link>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                        </template>

                        <!-- Template list (opcional) -->
                        <template #list="slotProps">
                            <div class="grid grid-cols-1 gap-4">
                                <div
                                    v-for="(membresia, index) in slotProps.items"
                                    :key="membresia.id"
                                    class="col-12 p-card bg-white border-1 surface-border border-round shadow-2 hover:shadow-4 transition-all transition-duration-300"
                                >
                                    <div class="p-card-body p-4">
                                        <div class="flex flex-col md:flex-row md:align-items-center md:justify-between">
                                            <!-- Información -->
                                            <div class="flex-1">
                                                <div class="flex align-items-center mb-3">
                                                    <div class="bg-primary-100 border-circle w-3rem h-3rem flex align-items-center justify-content-center mr-3">
                                                        <i class="pi pi-star text-primary text-xl"></i>
                                                    </div>
                                                    <div>
                                                        <h3 class="p-card-title text-lg font-bold text-900 m-0 line-height-1">
                                                            {{ membresia.nombre }}
                                                        </h3>
                                                        <div class="flex align-items-center mt-1">
                                                            <i class="pi pi-building text-400 mr-2"></i>
                                                            <span class="text-sm text-500">
                                                                {{ membresia.entidad?.nombre || 'No especificada' }}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p class="p-card-subtitle text-sm text-600 line-height-2">
                                                    {{ membresia.descripcion || 'Sin descripción disponible' }}
                                                </p>
                                            </div>

                                            <!-- Botón -->
                                            <div class="mt-4 md:mt-0 md:ml-4">
                                                <Link
                                                    :href="route('registromembresias.create', { membresia_id: membresia.id })"
                                                    class="p-button p-button-primary p-button-rounded no-underline hover:bg-primary-600 transition-colors transition-duration-200"
                                                >
                                                    <i class="pi pi-plus-circle mr-2"></i>
                                                    Inscribirme
                                                </Link>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Mensaje cuando no hay membresias -->
                        <template #empty>
                            <div class="text-center py-8 px-4">
                                <div class="bg-gray-50 border-round p-6 border-1 border-dashed border-300">
                                    <i class="pi pi-info-circle text-4xl text-400 mb-4 block"></i>
                                    <h3 class="text-xl font-medium text-700 mb-2">No hay membresías disponibles</h3>
                                    <p class="text-600 m-0">En este momento no tenemos membresías activas. ¡Vuelve pronto para nuevas opciones!</p>
                                </div>
                            </div>
                        </template>
                            </DataView>
                        </div>
                </div>
            </div>
        </div>
    </AppLayout>
</template>

<style scoped>
.p-card {
    transition: all 0.3s ease;
}

.p-card:hover {
    transform: translateY(-2px);
}

.p-card-body {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.p-card-title {
    color: #374151;
    font-weight: 700;
}

.p-card-subtitle {
    color: #6b7280;
    margin-bottom: 1rem;
}

/* Mejorar la apariencia de los botones */
.p-button {
    border-radius: 6px;
    font-weight: 500;
    transition: all 0.2s ease;
}

.p-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Estilos para el DataView */
.p-dataview .p-dataview-content {
    border: none;
    background: transparent;
}

.p-dataview .p-paginator {
    border-top: 1px solid #e5e7eb;
    background: #f9fafb;
    border-radius: 0 0 8px 8px;
}
</style>